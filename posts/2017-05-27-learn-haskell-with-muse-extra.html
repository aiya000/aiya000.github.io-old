<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>あいや☆ぱぶりっしゅぶろぐ！ - にこ、希と一緒に学ぶHaskell（番外）そのA「型クラスの定義と実装（Extra）」</title>
        <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
        <!-- bootstrap requires jquery -->
        <script type="text/javascript" src="../js/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="../js/bootstrap.min.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default">
            <div class="navbar-header">
                <a class="navbar-brand" href="../">あいや☆ぱぶりっしゅぶろぐ！</a>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="../">Home</a></li>
                <li><a href="../about.html">About</a></li>
                <li><a href="../profile.html">Profile</a></li>
                <li><a href="../products.html">Products</a></li>
                <li><a href="../archive.html">Archive</a></li>
            </ul>
        </nav>

        <div id="content">
            <h4>にこ、希と一緒に学ぶHaskell（番外）そのA「型クラスの定義と実装（Extra）」</h4>
            <link rel="stylesheet" type="text/css" href="../css/post.css" />

<div class="info">
    Posted on 2017/05/27 <br />
    

    Tags:
    
        [<a href="../tags/ラブライブ！で学ぶ.html">ラブライブ！で学ぶ</a>]
    
        [<a href="../tags/にこ、希と一緒に学ぶHaskell.html">にこ、希と一緒に学ぶHaskell</a>]
    
        [<a href="../tags/Haskell.html">Haskell</a>]
    

    <ul class="bookmarkers">
        <li> <!-- See https://about.twitter.com/ja/resources/buttons -->
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="public_ai000ya" data-size="small">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </li>

        <li> <!-- See http://b.hatena.ne.jp/guide/bbutton -->
            <a href="http://b.hatena.ne.jp/entry/aiya000.github.io/posts/2017-05-27-learn-haskell-with-muse-extra.html" class="hatena-bookmark-button" data-hatena-bookmark-title="にこ、希と一緒に学ぶHaskell（番外）そのA「型クラスの定義と実装（Extra）」 - あいや☆ぱぶりっしゅぶろぐ！" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
            <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
        </li>

        <li> <!-- See https://developers.facebook.com/docs/plugins/like-button?locale=ja_JP#configurator -->
            <div class="fb-like" data-href="https://aiya000.github.io/posts/2017-05-27-learn-haskell-with-muse-extra.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></div>
        </li>

        <li> <!-- See https://getpocket.com/publisher/button -->
            <a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-lang="ja"></a>
            <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
        </li>
    </ul>
</div>

<hr />

<ul>
<li><a href="./2017-05-06-learn-haskell-with-muse.html">本編その1（ことり、穂乃果と一緒に学ぶHaskell（入門）その1「代数的データ型の定義」）</a></li>
<li><a href="https://github.com/aiya000/aiya000.github.io/search?utf8=%E2%9C%93&amp;q=%22Haskell%2FMuse%3A%22&amp;type=Commits">更新履歴 - μ’sと一緒に学ぶHaskell</a></li>
</ul>
<h1 id="にこ希と一緒に学ぶhaskell番外について">にこ、希と一緒に学ぶHaskell（番外）について</h1>
<p>希 &amp; にこ「どうもこんにちは〜」</p>
<p>にこ「毎度おなじみ、Haskellerとして名の通ってる、みんなのニコニーです！」<br />
希「東條希やで〜」</p>
<p>にこ「あなたのハートににこにこにー♪」<br />
希「はーいぷしゅっ☆」</p>
<p>にこ「このコーナーですが、本編の補足、Haskellの面白い機能の紹介、などなどを進めていくニコ！」<br />
希「ちょうど本編を読んでくれてるHaskell入門中の子には悪いんやけど、この企画のレベルは……そうやね、たまにだいたい中級くらいになります」<br />
希「String, Text (Lazy/Strict), ByteString (Lazy/Strict)の関係がわかるとか、少しだけ言語拡張がわかるとかの人なら、Extra全部の記事を余裕で理解できると思うで♪」<br />
にこ「ごめんねぇ♡　でもその分にこが笑顔をサービスしちゃうニコッ！　にっこにっこにー♡」<br />
希「<strong>もしわからない内容があっても、『へー、こんなことができるんだー』くらいで楽に読んでもらって構わへんで！</strong>」</p>
<h1 id="型クラスとインターフェースって何が違うの-extra">型クラスとインターフェースって、何が違うの？ Extra</h1>
<p>希「ということで、この記事は本編の補足記事、もとい余談になります」</p>
<ul>
<li><a href="./2017-05-27-learn-haskell-with-muse.html">本編 - ことり、穂乃果と一緒に学ぶHaskell（入門）その4「型クラスの定義と実装」</a></li>
</ul>
<p>希「本編で、ことりちゃんがこんなこと言ってたね」</p>
<table>
<tbody>
<tr class="odd">
<td>こ</td>
<td>と</td>
<td>り「たまに『型クラスはインターフェースに似ている』とか言われるんだ。　……賛否両論が多数あるけどね」</td>
</tr>
</tbody>
</table>
<p>にこ「正直にこは、型クラスとインターフェースって、<strong>抽象を表す</strong>ってことくらいしか似てないと思うけど」<br />
希「まあまあそれの議論は置いておいてや。　引っ込みがつかなくなっちゃうからね」</p>
<p>希「もうひとつの、インターフェースと型クラスの大きな相違点として、<strong>型クラスはthisに依存しない</strong>っていうのがあるよ」</p>
<p>希「以下に<code>SingletonInt</code>データ型の定義と、その<code>Monoid</code>型クラスのインスタンス定義を示すで」</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">Data.Monoid</span> (<span class="dt">Monoid</span>(..))

<span class="kw">data</span> <span class="dt">SingletonInt</span> <span class="fu">=</span> <span class="dt">Zero</span>
  <span class="kw">deriving</span> (<span class="dt">Show</span>)

<span class="co">-- class Monoid a where</span>
<span class="co">--   mempty :: a</span>
<span class="co">--   mappend :: a -&gt; a -&gt; a</span>

<span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">SingletonInt</span> <span class="kw">where</span>
  mempty <span class="fu">=</span> <span class="dt">Zero</span>
  <span class="dt">Zero</span> <span class="ot">`mappend`</span> <span class="dt">Zero</span> <span class="fu">=</span> <span class="dt">Zero</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  print <span class="fu">$</span> <span class="dt">Zero</span> <span class="ot">`mappend`</span> <span class="dt">Zero</span> <span class="ot">`mappend`</span> mempty

<span class="co">-- vvv 出力 vvv</span>
<span class="co">-- Zero</span></code></pre></div>
<p>希「いくらか、まだ解説してない書き方をしちゃったね。　まあ後でことりちゃんが解説してくれるやろ」<br />
にこ「……てきとうね」</p>
<hr />
<ul>
<li>解説してないやつ
<ul>
<li><code>import</code></li>
<li><code>x ｀mappend｀ y</code>（関数の中置記法）</li>
<li><code>$</code>（関数適用演算子）
<ul>
<li><code>($) :: (a -&gt; b) -&gt; a -&gt; b</code></li>
</ul></li>
</ul></li>
</ul>
<p>…</p>
<p>にこ「希がてきとうすぎるから、少しだけ解説しておくわ」<br />
にこ「<code>import</code>は別の言語とほとんど同じだし、察してちょうだい」<br />
にこ「関数の中置記法っていうのは、2引数を持つ関数に対して与えられる糖衣構文よ。　<strong>通常の2引数関数呼び出しから、以下のように書き換えできるわ</strong>」</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- 足し算</span>
<span class="ot">plus ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>
plus x y <span class="fu">=</span> x <span class="fu">+</span> y

plus <span class="dv">10</span> <span class="dv">20</span>
    ↓
<span class="dv">10</span> <span class="ot">`plus`</span> <span class="dv">20</span></code></pre></div>
<p>にこ「最後に、<code>$</code>ね。　これは単なる1つの演算子にして、Haskellにとってすっっっっっっごい重要なものなの〜！」<br />
にこ「ネストした可読性の悪い悪しき括弧から、<code>$</code>に書き換えることができるわ！」</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">print (show <span class="dv">10</span>)
    ↓
print <span class="fu">$</span> show <span class="dv">10</span></code></pre></div>
<p>にこ「ネストがもう1つ深い例を見てみましょう」</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">print (show (<span class="dv">20</span> <span class="fu">-</span> <span class="dv">10</span>))
    ↓
print <span class="fu">$</span> show <span class="fu">$</span> <span class="dv">20</span> <span class="fu">-</span> <span class="dv">10</span></code></pre></div>
<p>にこ「少しステップを踏んでみましょう」</p>
<pre><code>   print (show (20 - 10))
=&gt; print (show $ 20 - 10)  -- 深い括弧を書き換え。　(-)が演算されてから($)が演算される
=&gt; print $ show $ 20 - 10  -- 一番右から処理される
=&gt; print $ show 10
=&gt; print &quot;10&quot;</code></pre>
<p>にこ「こんな感じね」</p>
<p>…</p>
<hr />
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">Data.Monoid</span> (<span class="dt">Monoid</span>(..))

<span class="kw">data</span> <span class="dt">SingletonInt</span> <span class="fu">=</span> <span class="dt">Zero</span>
  <span class="kw">deriving</span> (<span class="dt">Show</span>)

<span class="co">-- class Monoid a where</span>
<span class="co">--   mempty :: a</span>
<span class="co">--   mappend :: a -&gt; a -&gt; a</span>

<span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">SingletonInt</span> <span class="kw">where</span>
  mempty <span class="fu">=</span> <span class="dt">Zero</span>
  <span class="dt">Zero</span> <span class="ot">`mappend`</span> <span class="dt">Zero</span> <span class="fu">=</span> <span class="dt">Zero</span>

<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  print <span class="fu">$</span> <span class="dt">Zero</span> <span class="ot">`mappend`</span> <span class="dt">Zero</span> <span class="ot">`mappend`</span> mempty

<span class="co">-- vvv 出力 vvv</span>
<span class="co">-- Zero</span></code></pre></div>
<p>にこ「<code>SingletonInt</code>……0のみからなる集合なのね。　かなり自明なモノイドね」<br />
希「モノイド……<code>Monoid</code>ってゆーのは簡単に言うと、本編に出てきた<code>Magma</code>に、ある数学的（代数的）な法則と<code>mempty</code>を追加した抽象なんやけど」<br />
希「今は別にモノイドについてわからなくってもええよ。　<code>mempty</code>に注目して欲しいな」</p>
<p>希「<code>mempty</code>って、関数じゃなくて値なんよ。　それを型クラスで要求するようにしてる」<br />
希「対してJavaのインターフェースって、staticフィールドの実装を要求できないやん？　だから少し歪になってしまうん。　……ほらニコっち、Javaで書いてみて♪」</p>
<p>にこ「しょうがないわねえ。　にこってオシャレさんだからあんまりJavaみたいな言語って書かないんだけど〜、こんな感じかなぁ♪」<br />
希「こら！　敵を作るような発言するんやないの！」</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">interface</span> Monoid&lt;T&gt; {
	<span class="kw">public</span> T <span class="fu">mempty</span>();
	<span class="kw">public</span> T <span class="fu">mappend</span>(T x);
}

<span class="kw">abstract</span> <span class="kw">class</span> SingletonInt <span class="kw">implements</span> Monoid&lt;SingletonInt&gt; {
	<span class="at">@Override</span>
	<span class="kw">public</span> SingletonInt <span class="fu">mempty</span>() {
		<span class="kw">return</span> <span class="kw">new</span> <span class="fu">Zero</span>();
	}

	<span class="at">@Override</span>
	<span class="kw">public</span> SingletonInt <span class="fu">mappend</span>(SingletonInt x) {
		<span class="kw">return</span> <span class="kw">new</span> <span class="fu">Zero</span>();
	}
}

<span class="kw">class</span> Zero <span class="kw">extends</span> SingletonInt {
	<span class="at">@Override</span>
	<span class="kw">public</span> <span class="bu">String</span> <span class="fu">toString</span>() {
		<span class="kw">return</span> <span class="st">&quot;Zero&quot;</span>;
	}
}

<span class="kw">public</span> <span class="kw">class</span> Test {
	<span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {
		SingletonInt x = <span class="kw">new</span> <span class="fu">Zero</span>();
		SingletonInt y = <span class="kw">new</span> <span class="fu">Zero</span>();
		SingletonInt result = x.<span class="fu">mappend</span>(y).<span class="fu">mappend</span>(x.<span class="fu">mempty</span>());
		<span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(result);
	}
}

<span class="co">// vvv 出力 vvv</span>
<span class="co">// Zero</span></code></pre></div>
<p>希「うん、いいね。　さすがニコっちやね」<br />
にこ「まあこんなもんよ」<br />
希「ほな、解説お願い」<br />
にこ「はいはい。　ほら、ここを見て」</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="co">//                                         vv</span>
SingletonInt result = x.<span class="fu">mappend</span>(y).<span class="fu">mappend</span>(x.<span class="fu">mempty</span>());</code></pre></div>
<p>にこ「<code>mempty</code>が<code>this</code>オブジェクトに紐付いちゃってるのよ。　これはさっき希が言ってた通り、インターフェースがstaticフィールドを要求できないことから来る歪みよ」<br />
にこ「例えばもしこんなことができるなら、解決できるわね」</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">interface</span> Monoid&lt;T&gt; {
	<span class="kw">public</span> <span class="dt">static</span> T mempty;
	<span class="kw">public</span> T <span class="fu">mappend</span>(T x);
}

<span class="kw">abstract</span> <span class="kw">class</span> SingletonInt <span class="kw">implements</span> Monoid&lt;SingletonInt&gt; {
	<span class="at">@Override</span>
	<span class="kw">public</span> <span class="dt">static</span> SingletonInt mempty = <span class="kw">new</span> <span class="fu">Zero</span>();

	<span class="at">@Override</span>
	<span class="kw">public</span> SingletonInt <span class="fu">mappend</span>(SingletonInt x) {
		<span class="kw">return</span> <span class="kw">new</span> <span class="fu">Zero</span>();
	}
}

<span class="co">//                                         vvvvvvvvvvvvv</span>
SingletonInt result = x.<span class="fu">mappend</span>(y).<span class="fu">mappend</span>(SingletonInt.<span class="fu">mempty</span>);</code></pre></div>
<p>にこ「まあ、正直それはインターフェースの範疇じゃないし、Javaは間違ってないと思うけど。　それでもモノイドはインターフェースではうまく表現できないことの1つだと思うわ」</p>
<h1 id="のぞにこ">のぞにこ</h1>
<p>希「よしよし、上出来や♪」ﾅﾃﾞﾅﾃﾞ<br />
にこ「ちょっと！　頭なでなでするのやめなさいよ！　アイドルの髪は命なんだからね！」</p>
<p>希「よーし、スイーツ食べて帰るやでー」<br />
にこ「あらいいわね、さんせー！」ﾆｺｯ</p>
<h1 id="参考にしたページ">参考にしたページ</h1>
<ul>
<li><a href="http://dic.pixiv.net/a/%E7%9F%A2%E6%BE%A4%E3%81%AB%E3%81%93">矢澤にこ - ピクシブ百科事典</a></li>
</ul>

<hr />
<hr />

<p class="about-pr">
この記事はこちらから修正リクエストを送ることができます。 <br />
<a href="https://github.com/aiya000/aiya000.github.io/blob/develop/posts/2017-05-27-learn-haskell-with-muse-extra.md">にこ、希と一緒に学ぶHaskell（番外）そのA「型クラスの定義と実装（Extra）」 - github</a> <br />
ゴミ箱ボタンの左にある、鉛筆ボタンを押してね！
</p>

<script src="../js/facebook-sdk-2.8.js"></script>

        </div>

        <div id="footer">
            (*^o^) { This blog powerd by Haskell <a href="http://jaspervdj.be/hakyll">Hakyll</a> <br />
            and Uses <a href="http://nkmr6194.github.io/Umi/">Umi</a>
        </div>
    </body>
</html>
