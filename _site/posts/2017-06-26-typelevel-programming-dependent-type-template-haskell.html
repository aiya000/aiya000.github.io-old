<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>ã‚ã„ã‚„â˜†ã±ã¶ã‚Šã£ã—ã‚…ã¶ã‚ãï¼ - å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã«ã¤ã„ã¦ã®å ±å‘Š</title>
        <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
        <!-- bootstrap requires jquery -->
        <script type="text/javascript" src="../js/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="../js/bootstrap.min.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default">
            <div class="navbar-header">
                <a class="navbar-brand" href="../">ã‚ã„ã‚„â˜†ã±ã¶ã‚Šã£ã—ã‚…ã¶ã‚ãï¼</a>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="../">Home</a></li>
                <li><a href="../about.html">About</a></li>
                <li><a href="../profile.html">Profile</a></li>
                <li><a href="../products.html">Products</a></li>
                <li><a href="../archive.html">Archive</a></li>
            </ul>
        </nav>

        <div id="content">
            <h4>å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã«ã¤ã„ã¦ã®å ±å‘Š</h4>
            <link rel="stylesheet" type="text/css" href="../css/post.css" />

<div class="info">
    Posted on 2017/06/26 <br />
    

    Tags:
    
        [<a href="../tags/Haskell.html">Haskell</a>]
    

    <ul class="bookmarkers">
        <li> <!-- See https://about.twitter.com/ja/resources/buttons -->
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="public_ai000ya" data-size="small">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </li>

        <li> <!-- See http://b.hatena.ne.jp/guide/bbutton -->
            <a href="http://b.hatena.ne.jp/entry/aiya000.github.io/posts/2017-06-26-typelevel-programming-dependent-type-template-haskell.html" class="hatena-bookmark-button" data-hatena-bookmark-title="å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã«ã¤ã„ã¦ã®å ±å‘Š - ã‚ã„ã‚„â˜†ã±ã¶ã‚Šã£ã—ã‚…ã¶ã‚ãï¼" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚’ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã«è¿½åŠ "><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã‚’ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã«è¿½åŠ " width="20" height="20" style="border: none;" /></a>
            <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
        </li>

        <li> <!-- See https://developers.facebook.com/docs/plugins/like-button?locale=ja_JP#configurator -->
            <div class="fb-like" data-href="https://aiya000.github.io/posts/2017-06-26-typelevel-programming-dependent-type-template-haskell.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></div>
        </li>

        <li> <!-- See https://getpocket.com/publisher/button -->
            <a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-lang="ja"></a>
            <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
        </li>
    </ul>
</div>

<hr />

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li>index
<ul>
<li><a href="#%E3%81%93%E3%82%8C%E3%81%AF%E7%A7%81%E7%9A%84%E3%81%AA%E8%BF%91%E6%B3%81%E5%A0%B1%E5%91%8A%E3%81%A7%E3%81%99">ã“ã‚Œã¯ç§çš„ãªè¿‘æ³å ±å‘Šã§ã™</a></li>
<li><a href="#%E8%A7%A3%E8%AA%AC">è§£èª¬</a>
<ul>
<li><a href="#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E3%83%8F%E3%83%B3%E3%83%90%E3%83%BC%E3%82%AC%E3%83%BC%E3%81%AE%E7%9B%AE%E7%9A%84%E4%B8%BB%E9%A1%8C">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®ç›®çš„ã€ä¸»é¡Œ</a></li>
<li><a href="#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E3%83%8F%E3%83%B3%E3%83%90%E3%83%BC%E3%82%AC%E3%83%BC%E3%81%AE%E8%A6%8B%E3%81%A9%E3%81%93%E3%82%8D">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®è¦‹ã©ã“ã‚</a></li>
<li><a href="#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E3%83%8F%E3%83%B3%E3%83%90%E3%83%BC%E3%82%AC%E3%83%BC%E3%81%B8%E3%81%AEtopping%E3%81%AE%E8%BF%BD%E5%8A%A0">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¸ã®Toppingã®è¿½åŠ </a></li>
<li><a href="#th.hs">å‹ãƒ¬ãƒ™ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«TemplateHaskellã‚’ä½¿ã†ã®ã¯1å› å›ã£ãŸæ„ŸãŒã‚ã‚‹ï¼ˆTH.hsã«ã¤ã„ã¦ï¼‰</a></li>
<li><a href="#%E5%80%A4%E3%83%AC%E3%83%99%E3%83%AB%E3%83%8F%E3%83%B3%E3%83%90%E3%83%BC%E3%82%AC%E3%83%BC">å€¤ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼</a></li>
<li><a href="#%E3%81%A8%E3%81%84%E3%81%86%E3%81%93%E3%81%A8%E3%81%A7">ã¨ã„ã†ã“ã¨ã§</a></li>
</ul></li>
<li><a href="#%E5%85%83%E3%83%8D%E3%82%BF">å…ƒãƒã‚¿</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
<li><a href="#special-thanks-">Special Thanks !</a></li>
</ul></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1 id="ã“ã‚Œã¯ç§çš„ãªè¿‘æ³å ±å‘Šã§ã™">ã“ã‚Œã¯ç§çš„ãªè¿‘æ³å ±å‘Šã§ã™</h1>
<p>ã€€ã“ã“4æ—¥ãã‚‰ã„ã¯å‹ãƒ¬ãƒ™ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ä½“é¨“ã‚’ã—ã¦ã„ã¾ã—ãŸï¼<br />
ãã®æˆæœç‰©ã§ã‚ã‚‹ã€å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¯Hamburger.hsåŠã³Hamburger/TH.hsã‹ã‚‰æˆã‚Šã¾ã™ã€‚</p>
<!-- å‡ºåŠ›çµæœ {{{ -->
<p>å‡ºåŠ›çµæœ</p>
<pre class="console"><code>SHamburger (Space Space Space Space)
SHamburger (Cheese Space Space Space)
SHamburger (Cheese Tomato Space Space)
SHamburger (Cheese Tomato Meet Space)
SHamburger (Cheese Tomato Meet Ushi)</code></pre>
<!-- }}} -->
<!-- Hamburger.hs {{{ -->
<ul>
<li><a href="https://github.com/aiya000/learning-Haskell/blob/d4d29ad26673e828bc0b0358d1cde42c295eb50b/Language/Haskell/Extension/Room/Hamburger.hs">Hamburger.hs</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE DataKinds #-}</span>
<span class="ot">{-# LANGUAGE FlexibleInstances #-}</span>
<span class="ot">{-# LANGUAGE GADTs #-}</span>
<span class="ot">{-# LANGUAGE TemplateHaskell #-}</span>
<span class="ot">{-# LANGUAGE TypeFamilies #-}</span>

<span class="kw">module</span> <span class="dt">Hamberger</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Hamburger.TH</span> (defineInstances)

<span class="co">-- | A kind of the topping, and types.</span>
<span class="kw">data</span> <span class="dt">Topping</span> <span class="fu">=</span> <span class="dt">Space</span> <span class="co">-- ^ Mean a space, it can be inserted some @Topping@</span>
             <span class="fu">|</span> <span class="dt">Cheese</span> <span class="fu">|</span> <span class="dt">Tomato</span> <span class="fu">|</span> <span class="dt">Meet</span> <span class="fu">|</span> <span class="dt">Ushi</span>

<span class="co">-- |</span>
<span class="co">-- A type level function</span>
<span class="co">-- that maps @HamburgerT@ and @Topping@ to @HamburgerT@.</span>
<span class="co">--</span>
<span class="co">-- If @HamburgerC a b c d@ :: @HamburgerT@ of the domain has no space, or @Fail@ is specified to the domain,</span>
<span class="co">-- return @Fail@ type.</span>
<span class="kw">type</span> family <span class="dt">AddTopping</span> (<span class="ot">h ::</span> <span class="dt">HamburgerT</span>) (<span class="ot">t ::</span> <span class="dt">Topping</span>)<span class="ot"> ::</span> <span class="dt">HamburgerT</span> <span class="kw">where</span>
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> <span class="dt">Space</span> b c d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> t b c d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a <span class="dt">Space</span> c d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a t c d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a b <span class="dt">Space</span> d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a b t d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a b c <span class="dt">Space</span>) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a b c t
  <span class="dt">AddTopping</span> _ _ <span class="fu">=</span> <span class="dt">Fail</span>

<span class="co">-- | A kind of the abstract hamburger</span>
<span class="kw">data</span> <span class="dt">HamburgerT</span> <span class="fu">=</span> <span class="dt">HamburgerC</span> <span class="dt">Topping</span> <span class="dt">Topping</span> <span class="dt">Topping</span> <span class="dt">Topping</span> <span class="co">-- ^ A type constructor of the abstract hamburger</span>
                <span class="fu">|</span> <span class="dt">Fail</span> <span class="co">-- ^ Mean a fail of a mapping of @AddTopping@</span>


<span class="co">{- The dependent type -}</span>

<span class="co">-- |</span>
<span class="co">-- A concrete of the hamburger</span>
<span class="co">-- (A type constructor for a type of @HamburgerT@ kind).</span>
<span class="kw">data</span> <span class="dt">SHamburger</span> (<span class="ot">h ::</span> <span class="dt">HamburgerT</span>) <span class="kw">where</span>
  <span class="dt">Concrete</span><span class="ot"> ::</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">SHamburger</span> (<span class="dt">HamburgerC</span> a b c<span class="ot"> d ::</span> <span class="dt">HamburgerT</span>)

<span class="co">-- | A singleton type for @Topping@ kind.</span>
<span class="kw">data</span> <span class="dt">STopping</span> <span class="fu">=</span> <span class="dt">SSpace</span> <span class="fu">|</span> <span class="dt">SCheese</span> <span class="fu">|</span> <span class="dt">STomato</span> <span class="fu">|</span> <span class="dt">SMeet</span> <span class="fu">|</span> <span class="dt">SUshi</span>
  <span class="kw">deriving</span> (<span class="dt">Show</span>)

<span class="co">-- | Represent the simply dependent type</span>
<span class="kw">class</span> <span class="dt">Singleton</span> (<span class="ot">h ::</span> <span class="dt">HamburgerT</span>) <span class="kw">where</span>
<span class="ot">  sing ::</span> <span class="dt">SHamburger</span> h


<span class="co">-- Define any instances for 126 patterns !</span>
defineInstances


<span class="kw">type</span> <span class="dt">BasicHamburgerC</span> <span class="fu">=</span> <span class="dt">HamburgerC</span> <span class="dt">Space</span> <span class="dt">Space</span> <span class="dt">Space</span> <span class="dt">Space</span>

<span class="kw">type</span> <span class="dt">HamburgerC1</span> <span class="fu">=</span> <span class="dt">AddTopping</span> <span class="dt">BasicHamburgerC</span> <span class="dt">Cheese</span> <span class="co">-- these kind is @HamburgerT@</span>
<span class="kw">type</span> <span class="dt">HamburgerC2</span> <span class="fu">=</span> <span class="dt">AddTopping</span> <span class="dt">HamburgerC1</span> <span class="dt">Tomato</span>
<span class="kw">type</span> <span class="dt">HamburgerC3</span> <span class="fu">=</span> <span class="dt">AddTopping</span> <span class="dt">HamburgerC2</span> <span class="dt">Meet</span>
<span class="kw">type</span> <span class="dt">HamburgerC4</span> <span class="fu">=</span> <span class="dt">AddTopping</span> <span class="dt">HamburgerC3</span> <span class="dt">Ushi</span>
<span class="kw">type</span> <span class="dt">HamburgerC5</span> <span class="fu">=</span> <span class="dt">AddTopping</span> <span class="dt">HamburgerC4</span> <span class="dt">Ushi</span> <span class="co">-- = Fail</span>

x0 <span class="fu">=</span><span class="ot"> sing ::</span> <span class="dt">SHamburger</span> <span class="dt">BasicHamburgerC</span>
x1 <span class="fu">=</span><span class="ot"> sing ::</span> <span class="dt">SHamburger</span> <span class="dt">HamburgerC1</span>
x2 <span class="fu">=</span><span class="ot"> sing ::</span> <span class="dt">SHamburger</span> <span class="dt">HamburgerC2</span>
x3 <span class="fu">=</span><span class="ot"> sing ::</span> <span class="dt">SHamburger</span> <span class="dt">HamburgerC3</span>
x4 <span class="fu">=</span><span class="ot"> sing ::</span> <span class="dt">SHamburger</span> <span class="dt">HamburgerC4</span>
<span class="co">--x5 = sing :: SHamburger HamburgerC5 -- This is the compile error because Refl is not a Fail's value</span>


<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  print x0
  print x1
  print x2
  print x3
  print x4</code></pre></div>
<!-- }}} -->
<!-- Hamburger/TH.hs {{{ -->
<ul>
<li><a href="https://github.com/aiya000/learning-Haskell/blob/d4d29ad26673e828bc0b0358d1cde42c295eb50b/Language/Haskell/Extension/Room/Hamburger/TH.hs">Hamburger/TH.hs</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE TemplateHaskell #-}</span>

<span class="kw">module</span> <span class="dt">Hamburger.TH</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Language.Haskell.TH</span> (<span class="dt">Type</span>(..), <span class="dt">Name</span>, mkName, <span class="dt">Exp</span>(..), <span class="dt">DecsQ</span>, <span class="dt">Dec</span>(..), <span class="dt">Clause</span>(..), <span class="dt">Pat</span>(..), <span class="dt">Body</span>(..), <span class="dt">Lit</span>(..))

<span class="kw">type</span> <span class="dt">TypeName</span> <span class="fu">=</span> <span class="dt">String</span>

<span class="kw">type</span> <span class="dt">Topping4</span> <span class="fu">=</span> (<span class="dt">TypeName</span>, <span class="dt">TypeName</span>, <span class="dt">TypeName</span>, <span class="dt">TypeName</span>)


<span class="ot">topping4s ::</span> [<span class="dt">Topping4</span>]
topping4s <span class="fu">=</span> [(w, x, y, z) <span class="fu">|</span> w <span class="ot">&lt;-</span> toppings, x <span class="ot">&lt;-</span> toppings, y <span class="ot">&lt;-</span> toppings, z <span class="ot">&lt;-</span> toppings]
  <span class="kw">where</span>
<span class="ot">    toppings ::</span> [<span class="dt">TypeName</span>]
    toppings <span class="fu">=</span> [<span class="st">&quot;Space&quot;</span>, <span class="st">&quot;Cheese&quot;</span>, <span class="st">&quot;Tomato&quot;</span>, <span class="st">&quot;Meet&quot;</span>, <span class="st">&quot;Ushi&quot;</span>]

<span class="co">-- | Make a AST of @Type@ is like &quot;(HamburgerC Space Cheese Tomato Meet)&quot;</span>
<span class="ot">hamburgerC ::</span> <span class="dt">Topping4</span> <span class="ot">-&gt;</span> <span class="dt">Type</span>
hamburgerC (w, x, y, z) <span class="fu">=</span> <span class="dt">ParensT</span> (<span class="dt">ConT</span> (mkName <span class="st">&quot;HamburgerC&quot;</span>) 
                            <span class="ot">`AppT`</span> <span class="dt">ConT</span> (mkName w)
                            <span class="ot">`AppT`</span> <span class="dt">ConT</span> (mkName x)
                            <span class="ot">`AppT`</span> <span class="dt">ConT</span> (mkName y)
                            <span class="ot">`AppT`</span> <span class="dt">ConT</span> (mkName z))

<span class="co">-- |</span>
<span class="co">-- Make a AST of @Exp@ is like &quot;Concrete SSpace SCheese STomato SMeet&quot;</span>
<span class="co">-- (@Topping4@ elements are added &quot;S&quot; prefix for @STopping@).</span>
<span class="ot">concrete ::</span> <span class="dt">Topping4</span> <span class="ot">-&gt;</span> <span class="dt">Exp</span>
concrete (w, x, y, z) <span class="fu">=</span> <span class="dt">ConE</span> (mkName <span class="st">&quot;Concrete&quot;</span>)
                 <span class="ot">`AppE`</span> <span class="dt">ConE</span> (mkName <span class="fu">$</span> <span class="st">&quot;S&quot;</span> <span class="fu">++</span> w)
                 <span class="ot">`AppE`</span> <span class="dt">ConE</span> (mkName <span class="fu">$</span> <span class="st">&quot;S&quot;</span> <span class="fu">++</span> x)
                 <span class="ot">`AppE`</span> <span class="dt">ConE</span> (mkName <span class="fu">$</span> <span class="st">&quot;S&quot;</span> <span class="fu">++</span> y)
                 <span class="ot">`AppE`</span> <span class="dt">ConE</span> (mkName <span class="fu">$</span> <span class="st">&quot;S&quot;</span> <span class="fu">++</span> z)


<span class="co">-- | Define @Singleton@ instances and @Show@ instances for any pattern of @topping4@</span>
<span class="ot">defineInstances ::</span> <span class="dt">DecsQ</span>
defineInstances <span class="fu">=</span> <span class="kw">do</span>
  <span class="kw">let</span> singletonInstances <span class="fu">=</span> map defineSingletonInstance topping4s
      showInstances      <span class="fu">=</span> map defineShowInstance topping4s
  return <span class="fu">$</span> singletonInstances <span class="fu">++</span> showInstances
  <span class="kw">where</span>
<span class="ot">    defineSingletonInstance ::</span> <span class="dt">Topping4</span> <span class="ot">-&gt;</span> <span class="dt">Dec</span>
    defineSingletonInstance t4<span class="fu">@</span>(w, x, y, z) <span class="fu">=</span>
      <span class="dt">InstanceD</span> <span class="dt">Nothing</span> []
        (<span class="dt">ConT</span> (mkName <span class="st">&quot;Singleton&quot;</span>) <span class="ot">`AppT`</span> hamburgerC t4)
        [
          <span class="dt">FunD</span> (mkName <span class="st">&quot;sing&quot;</span>) [<span class="dt">Clause</span> [] (<span class="dt">NormalB</span> <span class="fu">$</span> concrete t4) []]
        ]

<span class="ot">    defineShowInstance ::</span> <span class="dt">Topping4</span> <span class="ot">-&gt;</span> <span class="dt">Dec</span>
    defineShowInstance t4<span class="fu">@</span>(w, x, y, z) <span class="fu">=</span>
      <span class="dt">InstanceD</span> <span class="dt">Nothing</span> []
        (<span class="dt">ConT</span> (mkName <span class="st">&quot;Show&quot;</span>) <span class="ot">`AppT`</span> <span class="dt">ParensT</span> (<span class="dt">ConT</span> (mkName <span class="st">&quot;SHamburger&quot;</span>) <span class="ot">`AppT`</span> hamburgerC t4))
        [
          <span class="dt">FunD</span> (mkName <span class="st">&quot;show&quot;</span>) [<span class="dt">Clause</span> [<span class="dt">WildP</span>] (<span class="dt">NormalB</span> <span class="fu">$</span>
              (<span class="dt">LitE</span> <span class="fu">.</span> <span class="dt">StringL</span> <span class="fu">$</span> <span class="st">&quot;SHamburger (&quot;</span> <span class="fu">++</span> w <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> x <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> y <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> z <span class="fu">++</span> <span class="st">&quot;)&quot;</span>)
          ) []]
        ]</code></pre></div>
<!-- }}} -->
<h1 id="è§£èª¬">è§£èª¬</h1>
<h2 id="å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®ç›®çš„ä¸»é¡Œ">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®ç›®çš„ã€ä¸»é¡Œ</h2>
<p>ã€€å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¯</p>
<ol style="list-style-type: decimal">
<li>5ã¤ä»¥ä¸Šã®ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚’è¿½åŠ ã•ã‚Œã‚‹ã¨ã€ä¾‹å¤–ã§ã¯ãªãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã§å¤±æ•—ã‚’å ±å‘Šã—ã¾ã™</li>
<li>å¤±æ•—ã—ã¦ã„ãªã„æœ‰åŠ¹ãªãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¯ã€å€¤ã¨ã—ã¦å–å¾—ã§ãã¾ã™</li>
</ol>
<p>ã¨ã„ã†ã®ãŒç›®çš„ï¼ˆä¸»é¡Œï¼‰ã§ã™ã€‚ ï¼ˆ2ã¤ç›®ã®ã‚„ã¤ã¯å¾Œä»˜ã‘ï¼‰</p>
<p>è©³ç´°ã«ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚</p>
<ol style="list-style-type: decimal">
<li>5ã¤ä»¥ä¸Šã®<code>Topping</code>ã‚’è¿½åŠ ã•ã‚Œã‚‹ã¨ï¼ˆ<code>x5</code>ã‚’ä»‹ã—ã¦ï¼‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™</li>
<li><code>Topping</code>ã®è¿½åŠ ã¯TypeFamiliesã®å‹é–¢æ•°<code>AddTopping</code>ã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚Œã¾ã™</li>
<li><code>Topping</code>ã®è¿½åŠ ã¯ç¨®<code>HamburgerT</code>ã®å‹<code>Hamburger a b c d</code>ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã¾ã™
<ul>
<li><code>type family AddTopping (h :: HamburgerT) (t :: Topping) :: HamburgerT</code></li>
<li>ï¼ˆæ“¬ä¼¼çš„ã«ã¯<code>HamburgerT -&gt; Topping -&gt; HamburgerT</code>ï¼‰</li>
</ul></li>
<li>ç¨®<code>HamburgerT</code>ã‚’æŒã¤å‹ã®ã†ã¡æœ‰åŠ¹ãªã‚‚ã®ï¼ˆã¤ã¾ã‚Š<code>Fail</code>ä»¥å¤–ï¼‰ã¯å€¤ãƒ¬ãƒ™ãƒ«ã«é™æ ¼ã§ãã¾ã™
<ul>
<li>å‚™è€ƒ: ä¾å­˜å‹ã£ã¦ã€å€¤ã‹ã‚‰å‹ã¸ã®æ˜‡æ ¼ã‚’æ‰±ã†ã ã‘ã®ã‚‚ã®ã˜ã‚ƒãªã‹ã£ãŸã‚“ã ã­</li>
</ul></li>
</ol>
<h2 id="å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®è¦‹ã©ã“ã‚">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®è¦‹ã©ã“ã‚</h2>
<p>ã€€ã“ã‚Œã®è¦‹ã©ã“ã‚ï¼ˆã“ã ã‚ã‚Šã©ã“ã‚ï¼‰ã¯ã€Hamburger.hsã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ã‚ã‚‹<code>x5</code>ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¨ã“ã‚ã§ã™ã€‚<br />
ãã‚Œã¯ã€<code>x5</code>ã®å‹ã§ã‚ã‚‹<code>SHamburger HambergerC5</code>ãŒ<code>SHamburger Fail</code>ã§ã‚ã‚Š ï¼ˆâ€»<a href="../posts/2017-06-24-ghci-type-level-debug.html">:kind!</a>ï¼‰ <code>Fail</code>ã¯Hamburger.hsã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹å‹ã‚¯ãƒ©ã‚¹<code>Singleton</code>ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã¯ãªã„ã‹ã‚‰ã§ã™ã€‚ ï¼ˆ<code>sing</code>é–¢æ•°ã¯<code>Singleton</code>ã®é–¢æ•°ï¼‰</p>
<p>ã€€ä»¥ä¸‹ã®å‹ã®<code>Singleton</code>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯</p>
<ul>
<li><code>SHamburger BasicHamburgerC</code></li>
<li><code>SHamburger HamburgerC1</code></li>
<li><code>SHamburger HamburgerC2</code></li>
<li><code>SHamburger HamburgerC3</code></li>
<li><code>SHamburger HamburgerC4</code></li>
</ul>
<p>TemplateHaskellã«ã‚ˆã£ã¦Hamburger.hsã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§å±•é–‹ã•ã‚Œã‚‹<code>defineInstances</code>ã«ã‚ˆã£ã¦å®šç¾©ã•ã‚Œã¾ã™ã€‚ <code>defineInstances</code>ã¯TH.hsã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ãƒ¡ã‚¿é–¢æ•°ã§ã™ã€‚</p>
<h2 id="å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¸ã®toppingã®è¿½åŠ ">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¸ã®Toppingã®è¿½åŠ </h2>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">type</span> family <span class="dt">AddTopping</span> (<span class="ot">h ::</span> <span class="dt">HamburgerT</span>) (<span class="ot">t ::</span> <span class="dt">Topping</span>)<span class="ot"> ::</span> <span class="dt">HamburgerT</span> <span class="kw">where</span>
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> <span class="dt">Space</span> b c d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> t b c d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a <span class="dt">Space</span> c d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a t c d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a b <span class="dt">Space</span> d) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a b t d
  <span class="dt">AddTopping</span> (<span class="dt">HamburgerC</span> a b c <span class="dt">Space</span>) t <span class="fu">=</span> <span class="dt">HamburgerC</span> a b c t
  <span class="dt">AddTopping</span> _ _ <span class="fu">=</span> <span class="dt">Fail</span></code></pre></div>
<p>ã€€ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãã®ã¾ã‚“ã¾ã§ã™ã­ã€TypeFamiliesã§ã™ã€‚</p>
<h2 id="å‹ãƒ¬ãƒ™ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«templatehaskellã‚’ä½¿ã†ã®ã¯1å›-å›ã£ãŸæ„ŸãŒã‚ã‚‹th.hsã«ã¤ã„ã¦">å‹ãƒ¬ãƒ™ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«TemplateHaskellã‚’ä½¿ã†ã®ã¯1å› å›ã£ãŸæ„ŸãŒã‚ã‚‹ï¼ˆTH.hsã«ã¤ã„ã¦ï¼‰</h2>
<p>ã€€TH.hsã«ã‚ã‚‹<code>defineInstances</code>ã¯<code>SHamburger (HamburgerC a b c d :: HamburgerT)</code>ã®å½¢ã‚’ã—ãŸ126å€‹ã®å‹ã®<code>Singleton</code>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ ï¼ˆã¤ã¾ã‚Š<code>SHamburger (h :: HamburgerT)</code>ã®ã†ã¡<code>Fail</code>ä»¥å¤–ã«å¯¾ã™ã‚‹ï¼‰</p>
<p>ã€€<code>Singleton</code>ã¯ä¾å­˜å‹ï¼ˆã‚‚ã©ãï¼Ÿï¼‰ã‚’æ‰±ã†ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚</p>
<p>ã€€<a href="http://konn-san.com/prog/2013-advent-calendar.html">å‚è€ƒã«ã—ãŸãƒšãƒ¼ã‚¸</a>ã§ã¯è‡ªç„¶æ•°ã®å¸°ç´æ³•ã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å®Ÿè£…ã—ã¦ã¾ã—ãŸãŒã€ ä¾å­˜å‹ã‚’ä½¿ã†ã“ã¨ã‚’è€ƒãˆã‚‹å‰ã«è€ƒãˆãŸæ§‹é€ ãŒå…¨ç„¶å¸°ç´çš„ã§ãªã‹ã£ãŸã®ã§ã€TemplateHaskellã‚’ä½¿ã£ã¦åŠ›æŠ€ã§è§£æ±ºã—ã¾ã—ãŸã€‚ ï¼ˆèª°ã‹ã†ã¾ã„æ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ï¼‰</p>
<h2 id="å€¤ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼">å€¤ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼</h2>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">SHamburger</span> (<span class="ot">h ::</span> <span class="dt">HamburgerT</span>) <span class="kw">where</span>
  <span class="dt">Concrete</span><span class="ot"> ::</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">STopping</span> <span class="ot">-&gt;</span> <span class="dt">SHamburger</span> (<span class="dt">HamburgerC</span> a b c<span class="ot"> d ::</span> <span class="dt">HamburgerT</span>)

<span class="kw">data</span> <span class="dt">STopping</span> <span class="fu">=</span> <span class="dt">SSpace</span> <span class="fu">|</span> <span class="dt">SCheese</span> <span class="fu">|</span> <span class="dt">STomato</span> <span class="fu">|</span> <span class="dt">SMeet</span> <span class="fu">|</span> <span class="dt">SUshi</span>
  <span class="kw">deriving</span> (<span class="dt">Show</span>)</code></pre></div>
<p>ã€€å„<code>Singleton</code>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®Ÿè£…ã¯<code>defineInstances</code>ãŒè¡Œã†ã®ã§å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã“ã®ã‚ˆã†ãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">instance</span> <span class="dt">Singleton</span> (<span class="dt">HamburgerC</span> <span class="dt">Cheese</span> <span class="dt">Ushi</span> <span class="dt">Meet</span> <span class="dt">Space</span>) <span class="kw">where</span>
  sing <span class="fu">=</span> <span class="dt">Concrete</span> <span class="dt">SCheese</span> <span class="dt">SUshi</span> <span class="dt">SMeet</span> <span class="dt">SSpace</span></code></pre></div>
<p>ã€€Haskellã§ã¯ä¾å­˜å‹ã¯å®Ÿéš›ã«ã¯ä½¿ãˆãªã„ã‚‰ã—ã„ã®ã§ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãªã‚‹å‹ã¨<code>sing</code>ï¼ˆã®å…·ä½“å€¤ï¼‰ã¯ã“ã®ã‚ˆã†ãªä¸€å¯¾ä¸€å¯¾å¿œã«ãªã‚Šã¾ã™ã€‚</p>
<pre><code>å‹ãƒ¬ãƒ™ãƒ«: HamburgerC Cheese Ushi Meet Space
å€¤ãƒ¬ãƒ™ãƒ«: Concrete SCheese SUshi SMeet SSpace</code></pre>
<p><code>HamburgerC</code>ã«<code>Cheese Ushi Meet Space</code>ãŒæŒ‡å®šã•ã‚Œã‚Œã°ã€ãã®å€¤ã¯<code>Concrete</code>ã¨<code>SCheese SUshi SMeet SSpace</code>ã«é™ã‚Š<br />
ãã®é€†ã‚‚ã¾ãŸåŒã˜ãé™ã‚‹æ„Ÿã˜ã§ã™ã€‚</p>
<p>ä¸€æ„çš„ã£ã¦ã“ã¨ã§ã™ã­ã€‚</p>
<h2 id="ã¨ã„ã†ã“ã¨ã§">ã¨ã„ã†ã“ã¨ã§</h2>
<p>ã€€é€²æ—å ±å‘Šã¯ã“ã‚“ãªæ„Ÿã˜ã§ã—ãŸ ğŸ•</p>
<h1 id="å…ƒãƒã‚¿">å…ƒãƒã‚¿</h1>
<blockquote class="twitter-tweet" data-lang="ja">
<p lang="ja" dir="ltr">
@ Uç§‘å„ä½<br><br>Javaèª²é¡Œã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰<a href="https://t.co/NOUtZAxB44">https://t.co/NOUtZAxB44</a>
</p>
â€” ç„¼ããã°ãƒ¡ãƒ­ãƒ³ãƒ‘ãƒ³@ğŸ£ (<span class="citation">@ice_arr</span>) <a href="https://twitter.com/ice_arr/status/876673209575251968">2017å¹´6æœˆ19æ—¥</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<ul>
<li><a href="http://konn-san.com/prog/2013-advent-calendar.html">å®šç†è¨¼æ˜ç³» Haskell - konn-san.com</a></li>
</ul>
<h1 id="special-thanks">Special Thanks !</h1>
<ul>
<li><a href="https://github.com/aiya000/learning-Haskell/pull/1">Type Level Humberger by Hexirp Â· Pull Request #1 Â· aiya000/learning-Haskell Â· GitHub</a>
<ul>
<li>and Haskell-jp members !</li>
</ul></li>
<li>åƒ•ãŒTemplateHaskellã«ã‚ˆã£ã¦ä½•å€‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ãŸã®ã‹ã‚’Rubyã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã§èª¿ã¹ã¦ãã‚ŒãŸã¶ã‚‰ã£ããƒãã‚“</li>
</ul>

<hr />
<hr />

<p class="about-pr">
ã“ã®è¨˜äº‹ã¯ã“ã¡ã‚‰ã‹ã‚‰ä¿®æ­£ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ <br />
<a href="https://github.com/aiya000/aiya000.github.io/blob/src/posts/2017-06-26-typelevel-programming-dependent-type-template-haskell.md">å‹ãƒ¬ãƒ™ãƒ«ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã«ã¤ã„ã¦ã®å ±å‘Š - github</a> <br />
ã‚´ãƒŸç®±ãƒœã‚¿ãƒ³ã®å·¦ã«ã‚ã‚‹ã€é‰›ç­†ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­ï¼
</p>

<script src="../js/facebook-sdk-2.8.js"></script>

        </div>

        <div id="footer">
            (*^o^) { This blog powerd by Haskell <a href="http://jaspervdj.be/hakyll">Hakyll</a> <br />
            and Uses <a href="http://nkmr6194.github.io/Umi/">Umi</a>
        </div>
    </body>
</html>
